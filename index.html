<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>端木子宸 | 灵感之源</title>
    <!-- 引入字体 -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Noto+Sans+SC:wght@300;400;700&display=swap" rel="stylesheet">
    
    <!-- 你的原有 CSS (假设在 css/style.css，这里为了演示保留部分关键样式) -->
    <!-- <link rel="stylesheet" href="css/style.css"> -->

    <style>
        :root {
            --bg-color: #050507; /* 与开场动画融合的深色背景 */
            --text-primary: #ffffff;
            --accent-color: #2997ff;
            --font-stack: "Inter", "Noto Sans SC", -apple-system, sans-serif;
        }

        body {
            margin: 0;
            background-color: var(--bg-color);
            color: var(--text-primary);
            font-family: var(--font-stack);
            overflow-x: hidden;
        }

        /* --- 1. 电影级开场容器 (Canvas层) --- */
        #cinematic-intro {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: 9999; /* 最顶层 */
            background-color: #000;
            transition: opacity 1.5s cubic-bezier(0.16, 1, 0.3, 1), visibility 1.5s;
        }
        
        /* 动画结束时隐藏开场层 */
        body.intro-finished #cinematic-intro {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }

        /* 恢复滚动条 */
        body.intro-active { overflow: hidden; }
        body.intro-finished { overflow: auto; }

        canvas {
            width: 100%;
            height: 100%;
        }

        /* 开场字幕 */
        #intro-text-layer {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100%;
            text-align: center;
            pointer-events: none;
        }

        .intro-caption {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90%;
            opacity: 0;
            filter: blur(12px);
            transition: opacity 0.8s, filter 0.8s, transform 1s;
        }

        .intro-caption.active {
            opacity: 1;
            filter: blur(0);
            transform: translate(-50%, -50%) scale(1);
        }

        .intro-caption.exit {
            opacity: 0;
            filter: blur(20px);
            transform: translate(-50%, -50%) scale(1.1);
        }

        /* 名字特效 */
        .name-title {
            font-size: 5rem;
            font-weight: 800;
            margin: 0;
            /* 金属流光文字 */
            background: linear-gradient(135deg, #fff 20%, #888 50%, #fff 80%);
            background-size: 200% auto;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: shine 3s linear infinite;
        }

        .sub-title {
            font-size: 1.2rem;
            color: #86868b;
            text-transform: uppercase;
            letter-spacing: 4px;
            margin-top: 15px;
        }

        /* 跳过按钮 */
        .skip-btn {
            position: absolute;
            bottom: 40px;
            right: 40px;
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            color: #fff;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            backdrop-filter: blur(10px);
            transition: all 0.3s;
            z-index: 1000;
        }
        .skip-btn:hover { background: rgba(255,255,255,0.2); }

        /* --- 2. 博客主界面 (初始隐藏) --- */
        #main-wrapper {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 1.5s ease 0.5s, transform 1.5s ease 0.5s; /* 延迟显示 */
        }

        body.intro-finished #main-wrapper {
            opacity: 1;
            transform: translateY(0);
        }

        /* 下面是你原本的 Navbar 和 Content 样式简化版 */
        .navbar {
            padding: 20px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .container { max-width: 1000px; margin: 0 auto; padding: 0 20px; }
        .nav-content { display: flex; justify-content: space-between; align-items: center; }
        .logo { font-weight: 700; font-size: 1.5rem; text-decoration: none; color: #fff; }
        .nav-links { list-style: none; display: flex; gap: 20px; }
        .nav-links a { color: #888; text-decoration: none; transition: color 0.3s; }
        .nav-links a.active, .nav-links a:hover { color: #fff; }

        .hero { text-align: center; padding: 100px 0; }
        .hero-title { font-size: 3rem; margin-bottom: 10px; }
        .hero-subtitle { color: #888; font-size: 1.2rem; }
        
        .posts-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 50px; }
        .skeleton-loader { height: 200px; background: rgba(255,255,255,0.05); border-radius: 12px; }

        @keyframes shine { to { background-position: 200% center; } }
        @media (max-width: 768px) { .name-title { font-size: 3rem; } }
    </style>
</head>
<body class="intro-active">

    <!-- 1. Apple 风格开场层 -->
    <div id="cinematic-intro">
        <canvas id="intro-canvas"></canvas>
        
        <div id="intro-text-layer">
            <!-- 场景 1 -->
            <div class="intro-caption" data-start="0.05" data-end="0.25">
                <p class="sub-title">Welcome</p>
                <h2 style="font-size: 3rem; margin:0;">灵感之源</h2>
            </div>
            
            <!-- 场景 2 -->
            <div class="intro-caption" data-start="0.30" data-end="0.55">
                <p class="sub-title">Explore & Create</p>
                <h2 style="font-size: 2.5rem; margin:0;">探索 · 记录 · 成长</h2>
            </div>

            <!-- 场景 3：主角登场 -->
            <div class="intro-caption" data-start="0.60" data-end="0.88">
                <p class="sub-title">Developer & Creator</p>
                <h1 class="name-title">端木子宸</h1>
            </div>
        </div>

        <button class="skip-btn" id="enter-site-btn">直接进入 ></button>
    </div>


    <!-- 2. 网站主内容 (你的原有结构) -->
    <div id="main-wrapper">
        <nav class="navbar">
            <div class="container nav-content">
                <a href="index.html" class="logo">MySpace</a>
                <ul class="nav-links">
                    <li><a href="#" class="active">首页</a></li>
                    <li><a href="#">关于</a></li>
                    <li><a href="#">归档</a></li>
                </ul>
            </div>
        </nav>

        <main class="container main-content">
            <section class="hero">
                <h1 class="hero-title">Keep Hungry, Keep Foolish.</h1>
                <p class="hero-subtitle">端木子宸的个人空间</p>
                
                <div style="margin-top: 40px; display: flex; justify-content: center; gap: 40px; color: #666;">
                    <div><strong style="color:white; display:block; font-size:1.5rem">12</strong> 文章</div>
                    <div><strong style="color:white; display:block; font-size:1.5rem">2026</strong> 始于</div>
                </div>
            </section>

            <section class="posts-section">
                <div style="border-bottom: 1px solid #333; padding-bottom: 20px; margin-bottom: 30px;">
                    <h2>最新发布</h2>
                </div>
                <div class="posts-grid">
                    <div class="skeleton-loader"></div>
                    <div class="skeleton-loader"></div>
                    <div class="skeleton-loader"></div>
                </div>
            </section>
            
            <footer style="text-align: center; color: #444; margin-top: 100px; padding-bottom: 40px;">
                &copy; 2026 端木子宸. All rights reserved.
            </footer>
        </main>
    </div>

    <!-- JS 逻辑 -->
    <script>
        const canvas = document.getElementById('intro-canvas');
        const ctx = canvas.getContext('2d');
        const DURATION = 8500; // 动画总时长 8.5秒
        let startTime = null;
        let animationFrameId;
        let isIntroFinished = false;

        // 状态管理
        let state = { width: 0, height: 0, progress: 0, stars: [] };

        function resize() {
            state.width = window.innerWidth;
            state.height = window.innerHeight;
            const dpr = window.devicePixelRatio || 1;
            canvas.width = state.width * dpr;
            canvas.height = state.height * dpr;
            ctx.scale(dpr, dpr);
            initStars();
        }

        function initStars() {
            state.stars = Array.from({length: 80}, () => ({
                x: (Math.random() - 0.5) * state.width * 2,
                y: (Math.random() - 0.5) * state.height * 2,
                z: Math.random() * 2 + 0.5,
                size: Math.random() * 1.5
            }));
        }

        const lerp = (a, b, t) => a + (b - a) * t;
        const easeInOut = t => t < .5 ? 2 * t * t : -1 + (4 - 2 * t) * t;

        // 核心绘制 (复用之前的逻辑，微调参数)
        function draw(progress) {
            ctx.fillStyle = '#000000';
            ctx.fillRect(0, 0, state.width, state.height);
            
            const cx = state.width / 2;
            const cy = state.height / 2;

            // 星空背景
            ctx.fillStyle = 'rgba(255, 255, 255, 0.4)';
            state.stars.forEach(star => {
                const scale = 1 + progress * 0.8;
                const x = cx + star.x * scale / star.z;
                const y = cy + star.y * scale / star.z;
                ctx.beginPath();
                ctx.arc(x, y, star.size, 0, Math.PI * 2);
                ctx.fill();
            });

            // 主体动画逻辑
            const baseSize = Math.min(state.width, state.height) * 0.35;
            ctx.save();
            ctx.translate(cx, cy);

            if (progress < 0.35) { // 阶段1: 能量球
                const p = progress / 0.35;
                drawGlowingShape(0, 0, baseSize, baseSize/2, p * Math.PI, 1, p);
            } 
            else if (progress < 0.65) { // 阶段2: 变形
                const p = (progress - 0.35) / 0.3;
                const easeP = easeInOut(p);
                const radius = lerp(baseSize/2, 40, easeP);
                const split = Math.sin(p * Math.PI) * 50;
                ctx.rotate(lerp(0, Math.PI/6, Math.sin(p*Math.PI))); // 微微倾斜
                drawStack(0, 0, baseSize, radius, split);
            } 
            else { // 阶段3: 芯片/名片展示
                const p = (progress - 0.65) / 0.35;
                const easeP = 1 - Math.pow(1 - p, 3);
                const scale = 1 + (1-easeP) * 0.3; 
                ctx.scale(scale, scale);
                drawFinalChip(0, 0, baseSize, easeP);
            }
            ctx.restore();
        }

        // 绘制辅助函数
        function drawGlowingShape(x, y, s, r, rot, alpha, t) {
            ctx.save();
            ctx.rotate(rot);
            const g = ctx.createLinearGradient(-s, -s, s, s);
            g.addColorStop(0, '#2997ff'); g.addColorStop(1, '#ff375f');
            ctx.shadowBlur = 40 + Math.sin(t*10)*10;
            ctx.shadowColor = '#bf5af2';
            ctx.fillStyle = g;
            ctx.beginPath(); ctx.roundRect(-s/2, -s/2, s, s, r); ctx.fill();
            ctx.restore();
        }

        function drawStack(x, y, s, r, offset) {
            [-1, 0, 1].forEach(i => {
                ctx.fillStyle = i === 0 ? '#111' : 'rgba(255,255,255,0.05)';
                ctx.strokeStyle = 'rgba(255,255,255,0.2)';
                ctx.lineWidth = 1;
                if(i===0) { ctx.shadowBlur=20; ctx.shadowColor='rgba(41,151,255,0.3)'; }
                else ctx.shadowBlur=0;
                
                ctx.beginPath();
                ctx.roundRect(-s/2, -s/2 + i*offset, s, s, r);
                ctx.fill(); ctx.stroke();
            });
        }

        function drawFinalChip(x, y, s, p) {
            // 金属质感背景
            const g = ctx.createLinearGradient(-s, -s, s, s);
            g.addColorStop(0, '#222'); g.addColorStop(0.5, '#444'); g.addColorStop(1, '#111');
            ctx.fillStyle = g;
            ctx.shadowBlur = 50 * p; ctx.shadowColor = 'rgba(255,255,255,0.1)';
            ctx.beginPath(); ctx.roundRect(-s/2, -s/2, s, s, 30); ctx.fill();
            
            // 边框
            ctx.strokeStyle = '#666'; ctx.lineWidth = 2; ctx.stroke();

            // LOGO: DZ (端木子宸)
            if (p > 0.5) {
                ctx.globalAlpha = (p - 0.5) * 2;
                ctx.fillStyle = '#fff';
                ctx.font = 'bold 80px -apple-system'; // 这里的字体大小可以根据需求调整
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.shadowBlur = 15; ctx.shadowColor = '#fff';
                ctx.fillText('DZ', 0, 0); // 显示简写
                ctx.globalAlpha = 1;
            }
            
            // 扫光特效
            const sheenPos = (Date.now() % 2500) / 2500 * (s * 3) - s * 1.5;
            ctx.save();
            ctx.beginPath(); ctx.roundRect(-s/2, -s/2, s, s, 30); ctx.clip();
            ctx.beginPath(); 
            ctx.moveTo(sheenPos, -s/2); ctx.lineTo(sheenPos+40, -s/2);
            ctx.lineTo(sheenPos-20, s/2); ctx.lineTo(sheenPos-60, s/2);
            ctx.fillStyle = 'rgba(255,255,255,0.2)'; ctx.fill();
            ctx.restore();
        }

        function updateCaptions(p) {
            document.querySelectorAll('.intro-caption').forEach(el => {
                const start = parseFloat(el.dataset.start);
                const end = parseFloat(el.dataset.end);
                if (p >= start && p <= end) {
                    el.classList.add('active'); el.classList.remove('exit');
                } else if (p > end && p < end + 0.1) {
                    el.classList.remove('active'); el.classList.add('exit');
                } else {
                    el.classList.remove('active'); el.classList.remove('exit');
                }
            });
        }

        // 动画循环
        function loop(timestamp) {
            if (isIntroFinished) return;
            if (!startTime) startTime = timestamp;
            const elapsed = timestamp - startTime;
            state.progress = Math.min(elapsed / DURATION, 1); // 不循环，只播一次

            draw(state.progress);
            updateCaptions(state.progress);

            if (state.progress < 1) {
                animationFrameId = requestAnimationFrame(loop);
            } else {
                // 动画自然结束
                finishIntro();
            }
        }

        // 结束开场，进入主站
        function finishIntro() {
            if (isIntroFinished) return;
            isIntroFinished = true;
            cancelAnimationFrame(animationFrameId);
            
            document.body.classList.remove('intro-active');
            document.body.classList.add('intro-finished');
        }

        // 事件监听
        window.addEventListener('resize', resize);
        document.getElementById('enter-site-btn').addEventListener('click', finishIntro);
        
        // 启动
        resize();
        requestAnimationFrame(loop);

    </script>
</body>
</html>